
# ./vi_vpss_demo
#CameraIdx: 0
#Output Path: /data/nfs
#IQ Path: /etc/iqfiles/
#Rkaiq XML DirPath: /etc/iqfiles/
[INFO  rtsp_demo.c:280:rtsp_new_demo] rtsp server demo starting on port 554
[DEBUG rtsp_demo.c:480:rtsp_new_session] add session path: /live/0
rtsp streamq_alloc size is 1753484
rkaiq log level ff0
[  341.321536] stream_cif_mipi_id0: s_power 1, entity use_count 1

************************** VERSION INFOS **************************
version release date: 2023-03-02
         AIQ:       AIQ v5.0x1.2-rc2
   IQ PARSER:       Calib v1.4.8,magicCode:1170944
************************ VERSION INFOS END ************************
ID: 0, sensor_name is m00_b_sc230ai 4-0030-1, iqfiles is /etc/iqfiles/
[  341.322452] stream_cif_mipi_id0: s_power 0, entity use_count 0
[  341.677503] stream_cif_mipi_id0: s_power 1, entity use_count 1
[  341.679325] stream_cif_mipi_id0: open video, entity use_countt 2
[  341.679658] stream_cif_mipi_id1: open video, entity use_countt 1
rk_aiq_uapi2_sysctl_init/prepare succeed
rk_aiq_uapi2_sysctl_start succeed
rockit log path (null), log_size = 0, can use export rt_log_path=, export rt_log_size= change
log_file = (nil)
RTVersion        00:05:41-696 {dump              :064} ---------------------------------------------------------
RTVersion        00:05:41-716 {dump              :065} rockit version: git-8040d59d5 Mon Mar 27 09:56:43 2023 +0800
RTVersion        00:05:41-727 {dump              :066} rockit building: built- 2023-03-27 10:57:39
RTVersion        00:05:41-735 {dump              :067} ---------------------------------------------------------
(null)           00:05:41-745 {log_level_init    :206}

 please use echo name=level > /tmp/rt_log_level set log level
        name: all cmpi mb sys vdec venc rgn vpss vgs tde avs wbc vo vi ai ao aenc adec
        log_level: 0 1 2 3 4 5 6

rockit default level 4, can use export rt_log_level=x, x=0,1,2,3,4,5,6 change
(null)           00:05:41-775 {read_log_level    :097} text is all=4
(null)           00:05:41-781 {read_log_level    :099} module is all, log_level is 4
[  341.695002] rkisp rkisp-vir0: first params buf queue
RTIsp3x          00:05:41-803 {ispInitDevice     :317} sensor name = m00_b_sc230ai 4-0030-1
(null)           00:05:41-808 {monitor_log_level :148} #Start monitor_log_level thread, arg:(nil)
RTIsp3x          00:05:41-817 {ispInitDevice     :320} sensor_index = 0
RKViDev          00:05:41-829 {vi_set_dev_attr   :445} VI_DEV_ATTR_S all parameter reserved
  === VI ATTRS INFO: ===
        devId  :      0
        chnId  :      0
        buffcnt:      0
        buffSize:     0
        width:        0
        height:       0
        Maxwidth:     0
        Maxwidth:     0
        streaming:    0
RKViChn          00:05:41-850 {prepareRuntime    :334} ---------------------------------------------------------
RKViChn          00:05:41-860 {prepareRuntime    :336} vi version: 1.98, name:vvi
RKViChn          00:05:41-868 {prepareRuntime    :337} rockit-ko version: vmpi:c130c8959511
RKViChn          00:05:41-876 {prepareRuntime    :338} rockit-ko building: -2023-04-13-17:04:15
RKViChn          00:05:41-884 {prepareRuntime    :339} ---------------------------------------------------------
RKViChn          00:05:41-894 {prepareRuntime    :358} mb pool create success, MBCnt= 2
RTIsp3x          00:05:41-903 {ispInitDevice     :317} sensor name = m00_b_sc230ai 4-0030-1
RTIsp3x          00:05:41-911 {ispInitDevice     :320} sensor_index = 0
                Sensor link info dump:
         media name           : /dev/media1
         model name           : rkisp0
         camera id            : 0
         sensor name          : m00_b_sc230ai 4-0030-1
         mainpath video name  : /dev/video11
         selfpath video name  : /dev/video12
         bypasspath video name: /dev/video13
         sensor type :2:
cmpi             00:05:41-946 {createRuntime     :582} [non-WRAP MODE]: buff size = 3133440
RTIsp3x          00:05:41-957 {ispInitDevice     :317} sensor name = m00_b_sc230ai 4-0030-1
RTIsp3x          00:05:41-963 {ispInitDevice     :320} sensor_index = 0
RTDeviceV4L2     00:05:41-973 {open              :135} cameraIndex:0, entityName:rkisp_selfpath
RTDeviceV4L2     00:05:41-980 {open              :141} open video name(/dev/video12)
RTDeviceV4L2     00:05:41-989 {ispCameraInfo     :554} current device:/dev/video12 isn't compatible(cap:0x84201000) device,memoryType:4, retry:0
RTDeviceV4L2     00:05:42-003 {ispInitFormat     :731} ioctl VIDIOC_S_FMT OK
RKViChn          00:05:42-011 {start             :883} =========== vi Start startRuntime ===========
RTDeviceV4L2     00:05:42-021 {ispStreamOn       :445} do ispStreamOn start
[  341.802635] vsys dev open 26
[  342.012503] rkisp queue buf done
[  342.030027] rkisp_hw ffa00000.rkisp: set isp clk = 198000000Hz
[  342.030061] rkcif-mipi-lvds: sditf_reinit_mode, mode->rdbk_mode 0, mode->name rkisp-vir0RTDeviceV4L2     00:05:42-049 {ispStreamOn       :, link_mo498} do ispStreamOn done
=== 0 ===
de 1
[  342.031627] rkcif-mipi-lvds: stream[0] starga_api version 1.9.1_[5]
rt cmpi             00:05:42-065 {SAMPLE_COMM_VPSS_C:071} vpss Grp 0's work unit is 1
111111111111111111111111111111111111111111111
MediaBufferPool  00:05:42-077 {registerBuffer    :186} buffer list is full! size: streaming
[ 3
42.031734] rockchip-mipi-cs86 {registerBuffer    :186} buf 3fer list is full! size: 3
=== 1 ===
MediaBufferPool  00:05:42-098 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool  00:05:42-107 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool  00:05:42-116 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool i2 ffa20000.mip 00:05:42-124 {registerBuffer    :186} buffer list is full!i- size: 3
csi2: stream on, srcMediaBufferPool  00:05:42-136 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool  00:05:42-145 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool  00:05:42-153 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool  00:05:42-162 {registerBuffer    :_sd: 8dc199ec,186} buffer list is full! size: 3
MediaBufferPool  s 00:05:42-172 {registerBuffer    :186} bufd_name:rockchip-csifer list is full! size: 3
MediaBufferPool  00:05:42-182 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool  00:05:42-190 {registerBuffer    :186} buffer list is full! size: 3
MediaBufferPool  00:05:42-199 {registerBuffer    :186} buf2-dphy0
[  3fer list is full! size: 3
MediaBufferPool  00:05:42-209 {registerBuffer    :42186} buffer list is full! size: .031746] rockchip-mi3
pi-cmpi             00:05:42-220 {SAMPLE_COMM_VPSS_C:071} vpss Grp 0's work unit is 1
csi2 ffa20000.mipi-csi2: stream ON
[  342.031809] rockchip-csi2-dphy0: dphy0, data_rate_mbps 371
[  342.031834] rockc2222222222222222222222222222222222222222222222222222
333333333333333333333333333333333[  342.074761] create vpss node = 1228800
[  342.228562] create vpss node = 3110400
[  342.232729] create vpss node = 1228800
[  342.234503] create vpss node = 3110400
[  342.246169] 8<--- cut here ---
[  342.269416] Unable to handle kernel NULL pointer dereference at virtual address 00000000
[  342.277507] pgd = 165d83a3
[  342.280209] [00000000] *pgd=00000000
[  342.283783] Internal error: Oops - BUG: 17 [#1] THUMB2
[  342.288918] Modules linked in: rockit(O) motor(O) rknpu mpp_vcodec(O) rga3 sc230ai phy_rockchip_csi2_dphy phy_rockchip_csi2_dphy_hw video_rkisp video_rkcif rk_dvbm [last unloaded: sc223a]
[  342.305616] CPU: 0 PID: 255 Comm: vrga Tainted: G           O      5.10.160 #14
[  342.312917] Hardware name: Generic DT based system
[  342.317711] PC is at memcpy+0x38/0x2dc
[  342.321520] LR is at rga_mpi_commit+0x87/0x21e [rga3]
[  342.326571] pc : [<b018b670>]    lr : [<af891499>]    psr: 200000b3
[  342.332827] sp : b19a3b9c  ip : 00000000  fp : b0f0cc00
[  342.338047] r10: af94eb9b  r9 : 60000013  r8 : b057f008
[  342.343267] r7 : b167b520  r6 : b0ab1360  r5 : 00000000  r4 : b19a3e44
[  342.349787] r3 : 00005017  r2 : 00000178  r1 : 00000000  r0 : b19a3bc0
[  342.356308] Flags: nzCv  IRQs off  FIQs on  Mode SVC_32  ISA Thumb  Segment user
[  342.363695] Control: 50c53c7d  Table: 019e0059  DAC: 00000055
[  342.369434] Process vrga (pid: 255, stack limit = 0x08114ea0)
[  342.375174] Stack: (0xb19a3b9c to 0xb19a4000)
[  342.379527] 3b80:                                                                00000000
[  342.387700] 3ba0: b0ab1360 b167b520 b057f008 b19a3bc0 b19a3e44 af891499 00000000 00000000
[  342.395873] 3bc0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.404043] 3be0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.412214] 3c00: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.420385] 3c20: 00000000 06a4dbe6 00000000 b199cf80 00000001 b1672f68 b1992e00 af947c09
[  342.428557] 3c40: b0ef3240 06a4dbe6 b0f0c200 b0ef2600 00000001 b1992200 b199cf80 b199cf80
[  342.436728] 3c60: 000002c3 af94eb01 af953046 06a4dbe6 af9504de b0ef2600 00000000 00020002
[  342.444899] 3c80: b199cf80 00010001 0000000c b0ef262c af953046 af943c09 af950f0c af94e1ea
[  342.453070] 3ca0: 000000b6 000000bc 0000002a 00000001 00000001 af9505a7 00000000 b28b0c00
[  342.461241] 3cc0: b1992200 b1992e00 b199cf80 06a4dbe6 00000000 b1992e00 b1992e00 b0597460
[  342.469413] 3ce0: af9509b9 af947c09 b19a3e64 af94eb9b b0f0c200 af941169 af95052d af94dd80
[  342.477584] 3d00: 000000f8 af9505a2 000000bd b19a3e69 ffffffff 00000001 b19a3f64 b019551b
[  342.485755] 3d20: 000000b7 00000000 b19a3f64 00000000 ffffffff 00000000 ffffffff ffffff04
[  342.493926] 3d40: ffff0a00 30313833 b19a3f64 b1670868 b19a3ddc b0194f6f b0f0b640 06a4dbe6
[  342.502098] 3d60: ffff0a00 b19a3de4 b19a3e69 b19a3de0 b19a3f64 b19a3e64 b19a3d98 af9530df
[  342.510271] 3d80: 00000100 b0196da1 ffffff10 ffff0a01 af95ae74 00000001 ffffff10 ffff0a01
[  342.518442] 3da0: 00000001 b006a30b b0601e00 06a4dbe6 00003a4c b199cf00 b287af00 06a4dbe6
[  342.526614] 3dc0: af95ae14 b199cf00 b287af00 b28b0c00 af95ae14 b287af00 b19a3e64 af947e5b
[  342.534785] 3de0: 000001f8 000000a2 b287a600 00000007 00000000 00000000 00000780 00000438
[  342.542956] 3e00: 00000780 00000438 0000000a 00000001 00000000 af95ae1c b057f008 b0f0b800
[  342.551126] 3e20: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.559297] 3e40: 00000000 b287a600 00000000 b0ef3000 b0f0b800 00000000 00000000 b1917600
[  342.567468] 3e60: 00000007 61677276 3338312d 00000000 00000000 00000000 00000000 00000000
[  342.575638] 3e80: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.583809] 3ea0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.591979] 3ec0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.600150] 3ee0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.608321] 3f00: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.616492] 3f20: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.624663] 3f40: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.632834] 3f60: 00000000 06a4dbe6 af95ae14 b1672f80 b1917280 ffffe000 b16a1d68 af947c09
[  342.641006] 3f80: af95ae14 b1672fa0 00000000 b0022907 b1917280 b0022865 00000000 00000000
[  342.649177] 3fa0: 00000000 00000000 00000000 b00082e9 00000000 00000000 00000000 00000000
[  342.657348] 3fc0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.665519] 3fe0: 00000000 00000000 00000000 00000000 00000013 00000000 00000000 00000000
[  342.673731] [<b018b670>] (memcpy) from [<af891499>] (rga_mpi_commit+0x87/0x21e [rga3])
[  342.681766] [<af891499>] (rga_mpi_commit [rga3]) from [<af947e5b>] (vrga_thread_fn+0x253/0x3d0 [rockit])
[  342.691283] [<af947e5b>] (vrga_thread_fn [rockit]) from [<b0022907>] (kthread+0xa3/0xac)
[  342.699375] [<b0022907>] (kthread) from [<b00082e9>] (ret_from_fork+0x11/0x28)
[  342.706593] Exception stack(0xb19a3fb0 to 0xb19a3ff8)
[  342.711644] 3fa0:                                     00000000 00000000 00000000 00000000
[  342.719814] 3fc0: 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000
[  342.727984] 3fe0: 00000000 00000000 00000000 00000000 00000013 00000000
[  342.734594] Code: f891 f05c f891 f07c (e8b1) 51f8
[  342.739383] ---[ end trace 3ca049845bb648ca ]---
hip-csi2-dphy csi2-dphy0: csi2_dphy_s_stream stream on:1, dphy0
333333333[  342.031842] rockch
ip-ccmpi             00:05:42-748 {SAMPLE_COMM_VENC_C:129} V_C:0 bufferCnt:3
si2-dphyMpiAdapterEncode 00:05:42-756 {ma_encode_create  :1653} ringbuf buf_size 3112960
[  342.765164] mpp_vcodec: 44: num_chan = 0
 csi2-dphy0: csi2_dphy_s_stream stream on:1, dphy0
[  342.765269] mpp_vcodec: 368: attr->max_width = 1920, attr->max_height = 1080
[  342.779174] mpp_vcodec: 103: chan_entry->handle 7142ff4a, enc 7142ff4a
[  342.787206] 755: MPP_ENC_SET_CFG in
[  342.797466] 524: MPP_ENC_SET_RC_CFG bps 7776000 [7290000 : 8262000] fps [30:30] gop 60
[  342.805387] 329: MPP_ENC_SET_PREP_CFG w:h [1920:1080] stride [1920:1080]
[  342.812239] 271: send header for set cfg change input/format
[  342.821811] 755: MPP_ENC_SET_CFG in
[  342.825443] 524: MPP_ENC_SET_RC_CFG bps 4096000 [3840000 : 4352000] fps [30:30] gop 50
[  342.833369] 271: send header for set cfg change rc_mode/fps/gop
[  342.839537] 755: MPP_ENC_SET_CFG in
[  342.843140] 524: MPP_ENC_SET_RC_CFG bps 4096000 [3840000 : 4352000] fps [30:30] gop 50
[  342.851216] 271: send header for set cfg change rc_mode/fps/gop
[  342.858926] 755: MPP_ENC_SET_CFG in
[  342.862560] 524: MPP_ENC_SET_RC_CFG bps 4096000 [3840000 : 4352000] fps [30:30] gop 50
[  342.870489] 271: send header for set cfg change rc_mode/fps/gop
[  342.878425] 755: MPP_ENC_SET_CFG in
[  342.882051] 524: MPP_ENC_SET_RC_CFG bps 4096000 [3840000 : 4352000] fps [30:30] gop 50
[  342.890120] 271: send header for set cfg change rc_mode/fps/gop
4444444444444444444444444444444444444444444444444444444444444444444
main initial finish
#Start venc_get_stream , arg:0xaea97980
cmpi             00:05:44-905 {SAMPLE_COMM_VENC_G:303} RK_MPI_VENC_GetStream chnid:0 fail 0XA004800E
cmpi             00:05:46-910 {SAMPLE_COMM_VENC_G:303} RK_MPI_VENC_GetStream chnid:0 fail 0XA004800E
cmpi             00:05:48-915 {SAMPLE_COMM_VENC_G:303} RK_MPI_VENC_GetStream chnid:0 fail 0XA004800E

cmpi             00:05:50-921 {SAMPLE_COMM_VENC_G:303} RK_MPI_VENC_GetStream chnid:0 fail 0XA004800E
^Z[1]+  Stopped                    ./vi_vpss_demo
#
#
# killall -9 vi_vpss_demo
# [  365.656055] rga_job: [tgid:517 pid:539] destroy request[1] when the user exits
[  365.656067] rga_job: [tgid:517 pid:539] destroy request[2] when the user exits
[  365.663357] rga_job: [tgid:517 pid:539] destroy request[3] when the user exits
[  365.670596] rga_job: [tgid:517 pid:539] destroy request[4] when the user exits
[  365.677823] rga_job: [tgid:517 pid:539] destroy request[5] when the user exits
[  365.685049] rga_job: [tgid:517 pid:539] destroy request[6] when the user exits
[  365.692317] rga_job: [tgid:517 pid:539] destroy request[7] when the user exits
[  365.699576] rga_job: [tgid:517 pid:539] destroy request[8] when the user exits
[  365.706810] rga_job: [tgid:517 pid:539] destroy request[9] when the user exits
[  365.714034] rga_job: [tgid:517 pid:539] destroy request[10] when the user exits
[  365.721328] rkcif-mipi-lvds: stream[0] start stopping, total mode 0x2, cur 0x2
[  365.765318] rockchip-mipi-csi2 ffa20000.mipi-csi2: stream off, src_sd: 8dc199ec, sd_name:rockchip-csi2-dphy0
[  365.775283] rockchip-mipi-csi2 ffa20000.mipi-csi2: stream OFF
[  365.782506] rockchip-csi2-dphy csi2-dphy0: csi2_dphy_s_stream_stop stream stop, dphy0
[  365.790351] rockchip-csi2-dphy csi2-dphy0: csi2_dphy_s_stream stream on:0, dphy0
[  365.798083] rockchip-csi2-dphy csi2-dphy0: csi2_dphy_s_stream stream on:0, dphy0
[  365.805947] rkcif-mipi-lvds: stream[0] stopping finished, dma_en 0x0

#
#
#
